export interface Req {
  event_data: EventData
  event_name: string
  initiator: Initiator
  user_id: number
  version: string
}

export interface EventData {
  added_by_uid: number
  assigned_by_uid: null
  checked: number
  child_order: number
  collapsed: number
  content: string
  date_added: string
  date_completed: string
  due: Due
  id: number
  in_history: number
  is_deleted: number
  labels: any[]
  legacy_project_id: number
  parent_id: null
  priority: number
  project_id: number
  responsible_uid: null
  section_id: null
  sync_id: null
  url: string
  user_id: number
}

export interface Due {
  date: string
  is_recurring: boolean
  lang: string
  string: string
  timezone: null
}

export interface Initiator {
  email: string
  full_name: string
  id: number
  image_id: string
  is_premium: boolean
}

// Require express and body-parser
const express = require("express")
const app = express()
const PORT = 3000

// Tell express to use body-parser's JSON parsing
app.use(express.json())

// Start express on the defined port
app.listen(PORT, () => console.log(`ðŸš€ Server running on port ${PORT}`))

app.get("/", (req: any, res: { send: (arg0: string) => void }) => {
  res.send("Hello!")
})

app.post(
  "/hook",
  (
    req,
    res: {
      status: (
        arg0: number
      ) => { (): any; new (): any; end: { (): void; new (): any } }
    }
  ) => {
    console.log(req)
    console.log(req.body) // Call your action on the request here
    const { event_data, event_name } = req.body
    console.log(event_data, event_name)
    res.status(200).end() // Responding is important
  }
)
// Generated by https://quicktype.io
